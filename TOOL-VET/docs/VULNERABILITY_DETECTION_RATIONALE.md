# MCP 취약점 탐지 방식의 논리적 근거 및 개선 방안

## 현재 탐지 방식의 논리적 근거

### 1. MCP-01: AI Tool Selection Risk

**탐지 방식:**
- 키워드 기반 휴리스틱: `delete`, `remove`, `destroy`, `clear`, `reset`, `admin`
- 위험한 도구 비율이 10% 미만일 때 취약점으로 탐지

**논리적 근거:**
- MCP는 AI가 사용자 의도를 해석하여 tool을 선택
- 위험한 도구가 일반 도구와 혼재하면 AI가 실수로 선택할 가능성 증가
- 소수의 위험한 도구는 더욱 주의가 필요

**잠재적 문제점:**
- 키워드 기반 탐지는 False Positive 발생 가능
- 도구의 실제 동작을 확인하지 않고 이름만으로 판단
- 컨텍스트에 따라 위험도가 달라질 수 있음

**개선 방안:**
- 도구의 실제 동작 분석 (정적/동적 분석)
- 도구 설명(description) 및 입력 스키마 분석
- 실제 공격 시나리오 테스트

### 2. MCP-02: Context Injection Risk

**탐지 방식:**
1. inputSchema가 없는 도구 탐지
2. 프록시 로그에서 동적 경로 패턴 탐지 (`/{param}/`, `/{uuid}/` 등)

**논리적 근거:**
- AI가 주입한 컨텍스트가 검증 없이 API 경로로 직접 사용되면 위험
- inputSchema가 없으면 AI 입력을 검증할 수 없음
- 동적 경로 사용은 컨텍스트 주입의 징후

**잠재적 문제점:**
- "AI가 주입한 컨텍스트"라는 표현의 근거 부족
- 프록시 로그만으로는 AI 주입인지 사용자 입력인지 구분 불가
- 정상적인 동적 경로 사용도 취약점으로 탐지 가능

**개선 방안:**
- 실제 AI Agent의 입력 추적
- 컨텍스트 검증 로직 확인 (정적 분석)
- 공격 시나리오 기반 테스트

### 3. MCP-03: Autonomous Execution Risk

**탐지 방식:**
- DELETE, PATCH, PUT 메서드를 사용하는 API 탐지
- 수정/삭제 작업 비율 계산

**논리적 근거:**
- AI가 사용자 확인 없이 자율적으로 실행 가능
- 수정/삭제 작업은 되돌릴 수 없으므로 위험

**잠재적 문제점:**
- 모든 수정/삭제 작업이 위험한 것은 아님
- 사용자 확인 메커니즘을 확인하지 않음
- 컨텍스트에 따라 위험도가 달라질 수 있음

**개선 방안:**
- 실제 사용자 확인 메커니즘 확인
- 영향 범위 분석 (어떤 리소스가 영향받는지)
- 공격 시나리오 테스트

### 4. MCP-04: Tool Combination Risk

**탐지 방식:**
- 읽기 도구와 쓰기 도구가 모두 있는지 확인
- 쓰기 도구 비율이 20% 이상일 때 취약점으로 탐지

**논리적 근거:**
- AI가 정보를 수집한 후 악용할 수 있음
- 읽기-쓰기 조합은 정보 유출 후 악용 가능

**잠재적 문제점:**
- 읽기-쓰기 조합이 반드시 위험한 것은 아님
- 권한 분리 메커니즘을 확인하지 않음
- 실제 공격 가능성을 입증하지 않음

**개선 방안:**
- 권한 분리 메커니즘 확인
- 실제 공격 시나리오 테스트
- 영향 범위 분석

## 전문가가 지적할 수 있는 주요 문제점

### 1. 탐지 근거의 명확성 부족
- **문제**: 패턴 기반 휴리스틱만으로 취약점 판단
- **해결**: 실제 동작 관찰 및 공격 시나리오 테스트

### 2. "실제 확인" 표현의 근거 부족
- **문제**: 프록시 로그만으로는 AI 주입인지 확인 불가
- **해결**: AI Agent의 실제 입력 추적 및 분석

### 3. 심각도 분류 기준의 주관성
- **문제**: 임의의 임계값 사용, 명확한 기준 부재
- **해결**: CVSS 스타일의 점수 체계 도입

### 4. 증거(Evidence)의 신뢰성 부족
- **문제**: 공격 가능성을 입증하지 못함
- **해결**: 공격 시나리오, 영향 범위, PoC 제공

### 5. False Positive/False Negative 처리 부재
- **문제**: 탐지된 취약점의 검증 로직 없음
- **해결**: 실제 공격 가능성 검증 및 화이트리스트 기반 필터링

## 개선 방안

### 1. 탐지 근거 강화
- 정적 분석: 소스 코드에서 실제 검증 로직 확인
- 동적 분석: 실제 공격 시나리오 테스트
- 메타데이터 분석: tool description, inputSchema 상세 분석

### 2. 증거 수집 강화
- 공격 시나리오(Attack Vector) 명시
- 영향 범위(Impact) 분석
- 재현 가능한 PoC(Proof of Concept) 제공

### 3. 심각도 분류 기준 명확화
- CVSS 스타일의 점수 체계 도입
- 공격 복잡도, 영향 범위, 인증 필요 여부 등 고려
- 컨텍스트 기반 심각도 조정

### 4. False Positive 감소
- 화이트리스트 기반 필터링
- 실제 공격 가능성 검증
- 정상 동작 패턴 학습

### 5. 검증 가능성 향상
- 재현 가능한 테스트 케이스 제공
- 상세한 로그 및 증거 자료
- 공격 시나리오 시뮬레이션

